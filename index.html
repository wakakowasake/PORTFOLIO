<!DOCTYPE html>
<html lang="ko" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš°ì§€í˜• í¬íŠ¸í´ë¦¬ì˜¤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: "var(--primary-color)",
                        bgDark: "#100a16", /* ë” ê¹Šì€ ë°°ê²½ìƒ‰ */
                        bgCard: "#1e1628", /* ì¹´ë“œ ë°°ê²½ìƒ‰ */
                        textGray: "#ab9db9"
                    },
                    fontFamily: {
                        sans: ['Noto Sans KR', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        :root { --primary-color: #8c2bee; }
        body { background-color: #100a16; color: white; }
        
        .glass-card {
            background: rgba(30, 22, 40, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
        }
        
        .glass-card:hover {
            border-color: rgba(140, 43, 238, 0.3);
            background: rgba(30, 22, 40, 0.8);
        }

        /* ìŠ¤í¬ë¡¤ë°” ë””ìì¸ */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #100a16; }
        ::-webkit-scrollbar-thumb { background: #302839; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #8c2bee; }
        
        /* í¸ì§‘ ëª¨ë“œ ìŠ¤íƒ€ì¼ */
        body.is-editing .editable-text-direct {
            border: 1px dashed #8c2bee;
            background: rgba(140, 43, 238, 0.1);
            cursor: text;
        }
        
        /* ë©”ì¸ì—ì„œ ìˆ˜ì • ë¶ˆê°€ëŠ¥í•˜ê³  í´ë¦­ë§Œ ë˜ëŠ” ìš”ì†Œë“¤ */
        body.is-editing .editable-trigger {
            border: 1px solid #8c2bee;
            position: relative;
        }

        body.is-editing .editable-img {
            cursor: pointer;
            border: 2px dashed #8c2bee !important;
            opacity: 0.8;
        }
        
        /* ë§í¬ í¸ì§‘ í‘œì‹œ */
        body.is-editing a.editable-link {
            cursor: context-menu !important; /* ìš°í´ë¦­ ëŠë‚Œ */
            border: 1px dotted #8c2bee;
        }

        /* í”„ë¡œí•„ ì‚¬ì§„ 1:1 ë¹„ìœ¨ ê°•ì œ ë° ì›í˜• */
        #profile-img {
            aspect-ratio: 1 / 1;
            object-fit: cover;
            border-radius: 50%;
        }

        /* ì¶”ê°€/ì‚­ì œ ë²„íŠ¼ ë° íˆ´ë°” ìŠ¤íƒ€ì¼ */
        .add-btn, .delete-btn, .editor-toolbar { display: none; }
        body.is-editing .add-btn { display: flex; }
        body.is-editing .delete-btn { display: block; }
        body.is-editing .editor-toolbar { display: flex; }

        .delete-btn {
            position: absolute;
            right: -10px; top: -10px;
            background: #ef4444; color: white;
            border-radius: 50%; width: 24px; height: 24px;
            text-align: center; line-height: 24px;
            z-index: 10;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        /* ë“œë˜ê·¸ ì•¤ ë“œë¡­ ìŠ¤íƒ€ì¼ */
        .dragging {
            opacity: 0.5;
            border: 2px dashed #8c2bee !important;
            background: rgba(140, 43, 238, 0.05);
        }
        
        body.is-editing #timeline-container .editable-trigger-wrapper,
        body.is-editing #project-container .editable-trigger-wrapper {
            cursor: move !important;
        }

        /* ë¶ë§ˆí¬ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .bookmark-card:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: rgba(140, 43, 238, 0.5);
        }

        /* ê°€ë¡œ ìŠ¤í¬ë¡¤ ì´ë¯¸ì§€ ë˜í¼ ìŠ¤íƒ€ì¼ */
        .horizontal-img-wrapper:focus {
            outline: 2px solid #8c2bee;
            outline-offset: 2px;
        }
        .horizontal-img-wrapper.dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }

        /* Custom Range Slider */
        input[type=range].skill-slider {
            -webkit-appearance: none;
            background: transparent;
            width: 100%;
        }
        input[type=range].skill-slider::-webkit-slider-runnable-track {
            height: 4px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
        }
        input[type=range].skill-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
            margin-top: -6px; /* (thumb height - track height) / 2 */
            box-shadow: 0 0 5px var(--primary-color);
        }

        /* ìŠ¤í‚¬ë°” ì»¨í…Œì´ë„ˆ */
        .skill-row { display: flex; align-items: center; gap: 10px; }
        .skill-icon { width: 24px; text-align: center; font-size: 14px; }
        .skill-name { width: 80px; font-size: 12px; font-weight: bold; }
        .skill-bar-bg { flex: 1; height: 6px; background: rgba(255,255,255,0.1); border-radius: 3px; overflow: hidden; position: relative; }
        .skill-bar-fill { height: 100%; background-color: var(--primary-color); border-radius: 3px; transition: width 0.3s; }
    </style>
</head>
<body class="min-h-screen flex flex-col p-4 md:p-8 max-w-7xl mx-auto">

    <input type="file" id="imageInput" accept="image/*" style="display: none;">
    <input type="file" id="detailImageInput" accept="image/*" style="display: none;" multiple>
    <input type="file" id="pdfInput" accept="application/pdf" style="display: none;">

    <header class="flex justify-between items-center mb-8 sticky top-0 z-40 py-4 bg-[#100a16]/80 backdrop-blur-md">
        <div class="flex items-center gap-4">
            <input type="color" id="themeColorPicker" class="w-8 h-8 rounded-full overflow-hidden cursor-pointer border-2 border-white/20 p-0 bg-transparent" value="#8c2bee" oninput="changeThemeColor(this.value)" title="í…Œë§ˆ ìƒ‰ìƒ ë³€ê²½">
            <button id="resetThemeBtn" onclick="resetThemeColor()" class="w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center transition-colors text-white/70 hover:text-white" title="ê¸°ë³¸ ìƒ‰ìƒ ë³µì›">
                <span class="material-symbols-outlined text-sm">restart_alt</span>
            </button>
            <button id="editToggleBtn" onclick="toggleEditMode()" class="flex items-center gap-2 bg-primary/20 text-primary px-4 py-2 rounded-lg hover:bg-primary/40 transition-all font-bold">
                <span class="material-symbols-outlined">edit_square</span>
                <span id="editBtnText">í¸ì§‘ ëª¨ë“œ</span>
            </button>
            <button id="exportBtn" onclick="exportHTML()" class="flex items-center gap-2 bg-green-500/20 text-green-500 px-4 py-2 rounded-lg hover:bg-green-500/40 transition-all font-bold">
                <span class="material-symbols-outlined">download</span>
                <span>ì‚¬ì´íŠ¸ ì €ì¥</span>
            </button>
        </div>
        <a href="mailto:example@gmail.com" id="contactBtn" class="editable-link bg-white text-black px-6 py-2 rounded-full font-bold hover:bg-gray-200 transition-colors flex items-center gap-2">
            <span>Contact Me</span>
            <span class="material-symbols-outlined text-sm">send</span>
        </a>
    </header>

    <main class="grid grid-cols-1 md:grid-cols-3 gap-6">
        
        <div class="glass-card rounded-3xl p-8 md:row-span-2 md:col-span-1 flex flex-col items-center text-center relative overflow-hidden group">
            <div class="relative w-48 h-48 mb-6 group-hover:scale-105 transition-transform duration-500">
                <img id="profile-img" src="https://via.placeholder.com/300" alt="Profile" class="w-full h-full border-4 border-primary/30 shadow-2xl editable-img">
            </div>
            
            <h1 id="profile-name" class="text-3xl font-black mb-2 editable-text-direct">ìš°ì§€í˜•</h1>
            <p id="profile-role" class="text-primary font-bold mb-6 editable-text-direct">Growth Marketer</p>
            
            <div id="profile-desc" class="text-textGray leading-relaxed mb-auto text-lg editable-text-direct">
                ë°ì´í„°ì— ê¸°ë°˜í•œ ì˜ì‚¬ê²°ì •ê³¼ ìŠ¤í† ë¦¬í…”ë§ìœ¼ë¡œ<br>ë¸Œëœë“œì˜ ì„±ì¥ì„ ê²¬ì¸í•©ë‹ˆë‹¤.
            </div>

            <div class="flex gap-4 mt-6">
                <a href="https://instagram.com" id="sns-insta" target="_blank" class="editable-link w-16 h-16 flex items-center justify-center bg-white/5 rounded-full hover:bg-gradient-to-tr hover:from-yellow-400 hover:via-red-500 hover:to-purple-500 transition-all hover:scale-110">
                    <i class="fab fa-instagram text-3xl"></i>
                </a>
                <a href="mailto:example@gmail.com" id="sns-gmail" class="editable-link w-16 h-16 flex items-center justify-center bg-white/5 rounded-full hover:bg-white hover:text-red-500 transition-all hover:scale-110">
                    <i class="far fa-envelope text-3xl"></i>
                </a>
            </div>
        </div>

        <div class="glass-card rounded-3xl p-6 md:col-span-1 flex flex-col justify-between relative overflow-hidden min-h-[160px]">
            <div class="flex justify-between items-start">
                <span class="w-3 h-3 bg-green-500 rounded-full animate-pulse shadow-[0_0_10px_#22c55e]"></span>
                <span class="material-symbols-outlined text-textGray">verified</span>
            </div>
            <div>
                <p class="text-textGray text-xs font-bold uppercase tracking-wider mb-2">Current Status</p>
                <h3 id="status-text" class="text-2xl font-bold editable-text-direct leading-tight">ì‹ ì… ë§ˆì¼€í„°<br>ì±„ìš© ì˜¤í”ˆ ğŸ‘‹</h3>
            </div>
        </div>

        <div class="glass-card rounded-3xl p-6 md:row-span-2 md:col-span-1 flex flex-col relative overflow-hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold flex items-center gap-2"><span class="material-symbols-outlined text-primary">history_edu</span> Experience</h2>
                <button onclick="addNewItem('exp')" class="add-btn bg-primary/20 text-primary px-2 py-1 rounded text-xs font-bold hover:bg-primary/40 transition-colors items-center gap-1">
                    <span class="material-symbols-outlined text-sm">add</span> ì¶”ê°€
                </button>
            </div>
            <div class="overflow-y-auto pr-2 space-y-6 flex-1 custom-scrollbar" id="timeline-container">
                <div id="item-exp1" class="editable-trigger-wrapper relative pl-6 border-l-2 border-primary/30 hover:border-primary transition-colors cursor-pointer group" onclick="openDetail('exp1')">
                    <div data-key="exp1-full-desc" style="display:none;"></div><div data-key="exp1-extra" style="display:none;"></div>
                    <button class="delete-btn material-symbols-outlined text-[16px]" onclick="deleteItem(event, 'item-exp1')">close</button>
                    <span class="absolute -left-[9px] top-0 w-4 h-4 rounded-full bg-bgDark border-2 border-primary group-hover:scale-110 transition-transform"></span>
                    <span class="text-xs text-primary font-bold mb-1 block" data-key="exp1-date">2024.03 - Present</span>
                    <h3 class="text-lg font-bold mb-1" data-key="exp1-title">Growth Marketer Intern</h3>
                    <p class="text-sm text-textGray" data-key="exp1-company">TechStart Inc.</p>
                </div>
                <div id="item-exp2" class="editable-trigger-wrapper relative pl-6 border-l-2 border-primary/30 hover:border-primary transition-colors cursor-pointer group" onclick="openDetail('exp2')">
                    <div data-key="exp2-full-desc" style="display:none;"></div><div data-key="exp2-extra" style="display:none;"></div>
                    <button class="delete-btn material-symbols-outlined text-[16px]" onclick="deleteItem(event, 'item-exp2')">close</button>
                    <span class="absolute -left-[9px] top-0 w-4 h-4 rounded-full bg-bgDark border-2 border-primary group-hover:scale-110 transition-transform"></span>
                    <span class="text-xs text-primary font-bold mb-1 block" data-key="exp2-date">2023.01 - 2024.02</span>
                    <h3 class="text-lg font-bold mb-1" data-key="exp2-title">ëŒ€í•™ìƒ ë§ˆì¼€í„° ì„œí¬í„°ì¦ˆ</h3>
                    <p class="text-sm text-textGray" data-key="exp2-company">CJ ENM</p>
                </div>
            </div>
        </div>

        <div class="glass-card rounded-3xl p-6 md:row-span-2 md:col-span-1 flex flex-col overflow-hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold flex items-center gap-2"><span class="material-symbols-outlined text-primary">rocket_launch</span> Recent Work</h2>
                <button onclick="addNewItem('proj')" class="add-btn bg-primary/20 text-primary px-2 py-1 rounded text-xs font-bold hover:bg-primary/40 transition-colors items-center gap-1">
                    <span class="material-symbols-outlined text-sm">add</span> ì¶”ê°€
                </button>
            </div>
            <div id="project-container" class="overflow-y-auto pr-2 space-y-4 flex-1 custom-scrollbar">
                <div id="item-proj1" class="editable-trigger-wrapper bg-bgDark/50 p-4 rounded-xl border border-white/5 hover:border-primary/50 transition-all cursor-pointer group" onclick="openDetail('proj1')">
                    <div data-key="proj1-full-desc" style="display:none;"></div><div data-key="proj1-extra" style="display:none;"></div>
                    <button class="delete-btn material-symbols-outlined text-[16px]" onclick="deleteItem(event, 'item-proj1')">close</button>
                    <div class="flex items-start gap-3">
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-start mb-1">
                                <span class="bg-primary/20 text-primary text-xs px-2 py-0.5 rounded font-bold truncate max-w-[120px]" data-key="proj1-category">General</span>
                                <span class="material-symbols-outlined text-gray-500 group-hover:text-white text-sm">arrow_outward</span>
                            </div>
                            <h3 class="text-lg font-bold text-white mb-1" data-key="proj1-title">2024 í•˜ë°˜ê¸° ë§ˆì¼€íŒ… ê¸°íšì„œ</h3>
                        </div>
                        <div class="proj-thumb-wrapper w-20 h-20 rounded-lg overflow-hidden flex-shrink-0 hidden border border-white/10 bg-bgDark">
                            <div class="proj-thumb-img w-full h-full bg-cover bg-center transition-transform duration-500 group-hover:scale-110"></div>
                        </div>
                    </div>
                </div>
                <div id="item-proj2" class="editable-trigger-wrapper bg-bgDark/50 p-4 rounded-xl border border-white/5 hover:border-primary/50 transition-all cursor-pointer group" onclick="openDetail('proj2')">
                    <div data-key="proj2-full-desc" style="display:none;"></div><div data-key="proj2-extra" style="display:none;"></div>
                    <button class="delete-btn material-symbols-outlined text-[16px]" onclick="deleteItem(event, 'item-proj2')">close</button>
                    <div class="flex items-start gap-3">
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-start mb-1">
                                <span class="bg-primary/20 text-primary text-xs px-2 py-0.5 rounded font-bold truncate max-w-[120px]" data-key="proj2-category">General</span>
                                <span class="material-symbols-outlined text-gray-500 group-hover:text-white text-sm">arrow_outward</span>
                            </div>
                            <h3 class="text-lg font-bold text-white mb-1" data-key="proj2-title">SNS ì¹´ë“œë‰´ìŠ¤ í¬íŠ¸í´ë¦¬ì˜¤</h3>
                        </div>
                        <div class="proj-thumb-wrapper w-20 h-20 rounded-lg overflow-hidden flex-shrink-0 hidden border border-white/10 bg-bgDark">
                            <div class="proj-thumb-img w-full h-full bg-cover bg-center transition-transform duration-500 group-hover:scale-110"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="md:col-span-1 flex flex-col gap-4">
            <!-- Performance Section (Inline Graphs) -->
            <div id="item-skill-perf" class="glass-card rounded-3xl p-6 flex flex-col justify-center relative">
                <div class="flex items-center gap-2 mb-4">
                    <span class="material-symbols-outlined text-2xl text-blue-400">analytics</span>
                    <h3 class="font-bold text-lg">Performance</h3>
                </div>
                
                <!-- ë°ì´í„° ì €ì¥ì†Œ (ìˆ¨ê¹€) -->
                <div id="skill-data" data-key="skill-perf-values" style="display:none;">80,70,60,90,95</div>

                <div id="skill-container" class="space-y-1">
                    <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ë Œë”ë§ë¨ -->
                </div>
            </div>

            <!-- Copywriting Section (Inline Awards) -->
            <div id="item-skill-copy" class="glass-card rounded-3xl p-6 flex flex-col relative">
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center gap-2">
                        <span class="material-symbols-outlined text-2xl text-pink-400">emoji_events</span>
                        <h3 class="font-bold text-lg">Awards</h3>
                    </div>
                    <button onclick="addAward()" class="add-btn bg-pink-500/20 text-pink-400 px-2 py-1 rounded text-xs font-bold hover:bg-pink-500/40 transition-colors items-center gap-1">
                        <span class="material-symbols-outlined text-sm">add</span>
                    </button>
                </div>
                
                <div id="awards-container" class="space-y-3 overflow-y-auto custom-scrollbar max-h-[200px] pr-1">
                    <!-- ê¸°ë³¸ ìˆ˜ìƒ ë‚´ì—­ -->
                    <div class="award-card bg-white/5 p-3 rounded-xl border border-white/5 flex items-center gap-3 group relative">
                        <div class="w-10 h-10 rounded-full bg-yellow-500/20 flex items-center justify-center flex-shrink-0 text-yellow-400">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="text-xs text-gray-400 editable-text-direct">2023.12</div>
                            <div class="font-bold text-sm text-white truncate editable-text-direct">ëŒ€í•™ìƒ ë§ˆì¼€íŒ… ê³µëª¨ì „ ëŒ€ìƒ</div>
                        </div>
                        <button class="delete-btn material-symbols-outlined text-[14px]" onclick="this.closest('.award-card').remove(); saveContent();">close</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div class="glass-card rounded-3xl overflow-hidden relative group cursor-pointer min-h-[200px] mt-6 h-64" onclick="editMap()">
        <iframe id="map-frame" src="https://maps.google.com/maps?q=ìˆ­ì‹¤ëŒ€í•™êµ&t=&z=15&ie=UTF8&iwloc=&output=embed" 
            class="w-full h-full border-0 filter grayscale invert contrast-125 opacity-70 hover:opacity-100 transition-opacity" allowfullscreen="" loading="lazy"></iframe>
        <div class="absolute bottom-4 left-4 bg-bgDark/80 px-3 py-1 rounded-lg text-xs font-bold backdrop-blur-sm pointer-events-none flex items-center gap-1">
            <span class="material-symbols-outlined text-[14px] text-primary">location_on</span>
            Soongsil Univ.
        </div>
    </div>

    <footer class="mt-6 text-center text-textGray text-xs">
        <p>Â© 2025 Woo Jee-hyung. All rights reserved.</p>
    </footer>

    <div id="detail-overlay" class="fixed inset-0 bg-bgDark z-50 hidden overflow-y-auto animate-[fadeIn_0.3s_ease-out]">
        <button onclick="closeDetail()" class="fixed top-6 right-6 z-[60] bg-black/50 p-2 rounded-full hover:bg-primary text-white transition-colors">
            <span class="material-symbols-outlined text-3xl">close</span>
        </button>
        
        <div class="w-full h-80 relative group">
            <div class="absolute inset-0 bg-gradient-to-t from-bgDark to-transparent"></div>
            <div class="absolute top-6 left-6 flex items-center gap-3">
                 <div class="bg-primary px-3 py-1 rounded-full text-xs font-bold text-white">PORTFOLIO DETAIL</div>
            </div>
        </div>

        <div class="max-w-4xl mx-auto -mt-32 relative px-4 pb-20">
            <div class="glass-card bg-[#1e1628] p-8 md:p-12 rounded-3xl shadow-2xl border border-white/10">
                
                <div class="flex gap-4 mb-6 text-xl font-bold text-primary">
                    <span id="detail-date" class="editable-detail">DATE</span>
                    <span>|</span>
                    <span id="detail-company" class="editable-detail">COMPANY / ORG</span>
                </div>

                <h1 id="detail-title" class="text-4xl md:text-5xl font-black mb-6 leading-tight editable-detail">ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”</h1>
                
                <hr class="border-white/10 my-8">

                <div id="detail-exp-manager" class="hidden mb-8 p-5 bg-white/5 rounded-2xl border border-white/10">
                    <!-- Experience ìƒì„¸ í˜ì´ì§€ ì „ìš©: í”„ë¡œì íŠ¸ ì—°ê²° UIê°€ ì—¬ê¸°ì— ë“¤ì–´ê°‘ë‹ˆë‹¤ -->
                </div>

                <div class="space-y-6">
                    <div id="detail-toolbar" class="editor-toolbar gap-2 mb-2">
                        <button onclick="triggerDetailImage()" class="bg-white/10 hover:bg-white/20 px-3 py-1 rounded text-sm flex items-center gap-1 transition-colors">
                            <span class="material-symbols-outlined text-sm">image</span> ì‚¬ì§„ ì‚½ì…
                        </button>
                        <button onclick="insertDetailLink()" class="bg-white/10 hover:bg-white/20 px-3 py-1 rounded text-sm flex items-center gap-1 transition-colors">
                            <span class="material-symbols-outlined text-sm">link</span> ë§í¬ ì‚½ì…
                        </button>
                        <button onclick="insertBookmark()" class="bg-white/10 hover:bg-white/20 px-3 py-1 rounded text-sm flex items-center gap-1 transition-colors">
                            <span class="material-symbols-outlined text-sm">bookmark</span> ë¶ë§ˆí¬ ì‚½ì…
                        </button>
                        <button onclick="triggerPdfInput()" class="bg-white/10 hover:bg-white/20 px-3 py-1 rounded text-sm flex items-center gap-1 transition-colors">
                            <span class="material-symbols-outlined text-sm">picture_as_pdf</span> PDF ì²¨ë¶€
                        </button>
                    </div>
                    <h3 id="detail-content-header" class="text-lg font-bold text-white">ğŸ“Œ ìƒì„¸ ë‚´ìš© ë° ì„±ê³¼</h3>
                    <div id="detail-desc" class="text-lg text-gray-300 leading-relaxed editable-detail whitespace-pre-line min-h-[100px]">
                        ì—¬ê¸°ë¥¼ í´ë¦­í•˜ì—¬ ìƒì„¸ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”.
                    </div>
                </div>

                <div id="detail-extra-section" class="mt-10 p-6 bg-white/5 rounded-xl border border-white/5">
                    <h3 class="text-sm font-bold text-gray-400 mb-2 uppercase">Tools / Awards / Links</h3>
                    <div id="detail-extra" class="text-white font-medium editable-detail whitespace-pre-line">
                        ê´€ë ¨ëœ íˆ´ì´ë‚˜ ë§í¬, ìˆ˜ìƒ ë‚´ì—­ì„ ì…ë ¥í•˜ì„¸ìš”.
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        let isEditing = false;
        let currentActiveKey = null; // í˜„ì¬ ì—´ë ¤ìˆëŠ” ì¹´ë“œì˜ í‚¤ (ì—°ë™ìš©)
        let currentImgElement = null; // í˜„ì¬ ì—…ë¡œë“œí•˜ë ¤ëŠ” ì´ë¯¸ì§€ íƒœê·¸
        const skillConfig = [
            { name: 'PPT', icon: 'fa-file-powerpoint', color: 'text-orange-500' },
            { name: 'Photoshop', icon: 'fa-palette', color: 'text-blue-500' },
            { name: 'Premiere Pro', icon: 'fa-film', color: 'text-purple-500' },
            { name: 'Excel', icon: 'fa-file-excel', color: 'text-green-500' },
            { name: 'Word', icon: 'fa-file-word', color: 'text-blue-600' }
        ];
        
        // 1. ì´ˆê¸° ë¡œë“œ
        window.onload = function() { loadContent(); renderSkills(); }

        // í…Œë§ˆ ìƒ‰ìƒ ë³€ê²½
        function changeThemeColor(color) {
            document.documentElement.style.setProperty('--primary-color', color);
            saveContent(); // ìƒ‰ìƒ ë³€ê²½ ì¦‰ì‹œ ì €ì¥
        }

        // í…Œë§ˆ ìƒ‰ìƒ ì´ˆê¸°í™”
        function resetThemeColor() {
            const defaultColor = "#8c2bee";
            changeThemeColor(defaultColor);
            document.getElementById('themeColorPicker').value = defaultColor;
        }

        // 2. í¸ì§‘ ëª¨ë“œ í† ê¸€
        function toggleEditMode() {
            isEditing = !isEditing;
            const body = document.body;
            const btnText = document.getElementById('editBtnText');
            
            if (isEditing) {
                body.classList.add('is-editing');
                btnText.innerText = "ì €ì¥ í•˜ê¸°";
                
                // ì§ì ‘ ìˆ˜ì • ê°€ëŠ¥í•œ ìš”ì†Œë“¤ (í”„ë¡œí•„ ë“±)
                document.querySelectorAll('.editable-text-direct').forEach(el => el.contentEditable = "true");
                
                // ìŠ¤í‚¬ ìŠ¬ë¼ì´ë” ë³´ì´ê¸°
                renderSkills();

                // ë©”ì¸ ë¦¬ìŠ¤íŠ¸(ê²½í—˜ ë“±)ëŠ” í´ë¦­ ìœ ë„ ìŠ¤íƒ€ì¼ ì ìš© (editable-trigger í´ë˜ìŠ¤ í™œìš©)
                document.querySelectorAll('.editable-trigger-wrapper').forEach(el => el.classList.add('editable-trigger'));
                
                // ë“œë˜ê·¸ ì•¤ ë“œë¡­ í™œì„±í™”
                document.querySelectorAll('#timeline-container .editable-trigger-wrapper, #project-container .editable-trigger-wrapper')
                        .forEach(el => el.setAttribute('draggable', 'true'));

                // alert ì œê±°ë¨
            } else {
                body.classList.remove('is-editing');
                btnText.innerText = "í¸ì§‘ ëª¨ë“œ";
                
                document.querySelectorAll('[contentEditable]').forEach(el => el.contentEditable = "false");
                document.querySelectorAll('.editable-trigger-wrapper').forEach(el => el.classList.remove('editable-trigger'));
                
                // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë¹„í™œì„±í™”
                document.querySelectorAll('#timeline-container .editable-trigger-wrapper, #project-container .editable-trigger-wrapper')
                        .forEach(el => el.setAttribute('draggable', 'false'));

                // ìŠ¤í‚¬ ìŠ¬ë¼ì´ë” ìˆ¨ê¸°ê¸° (ë·° ëª¨ë“œ)
                renderSkills();

                saveContent(); // ì €ì¥
                // alert ì œê±°ë¨
            }
        }

        // 3. ìƒì„¸ í˜ì´ì§€ ì—´ê¸° (ë°ì´í„° ì—°ë™ í•µì‹¬ ë¡œì§)
        function openDetail(key) {
            currentActiveKey = key; // í˜„ì¬ í‚¤ ì €ì¥
            const overlay = document.getElementById('detail-overlay');
            const isExp = key.startsWith('exp');

            // [ìˆ˜ì •] ìŠ¤í‚¬ ì¹´ë“œëŠ” ìƒì„¸ í˜ì´ì§€ë¥¼ ì—´ì§€ ì•ŠìŒ
            if (key.startsWith('skill')) return;

            const isProj = key.startsWith('proj');
            const contentHeader = document.getElementById('detail-content-header');
            
            // ë©”ì¸ í™”ë©´ì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const mainTitle = document.querySelector(`[data-key="${key}-title"]`)?.innerText || "";
            const mainDate = document.querySelector(`[data-key="${key}-date"]`)?.innerText || "";
            const mainCompany = document.querySelector(`[data-key="${key}-company"]`)?.innerText || "";
            const mainDesc = document.querySelector(`[data-key="${key}-desc"]`)?.innerText || "";
            
            // ìƒì„¸ í˜ì´ì§€ì— ë¿Œë¦¬ê¸°
            document.getElementById('detail-title').innerText = mainTitle;
            document.getElementById('detail-date').innerText = mainDate;
            document.getElementById('detail-company').innerText = mainCompany;
            
            // [ê¸°ëŠ¥ ì¶”ê°€] Performance ìŠ¤í‚¬ í˜ì´ì§€ëŠ” ë§‰ëŒ€ ê·¸ë˜í”„ë¡œ í‘œì‹œ
            if (key === 'skill-perf') {
                // ê¸°ë³¸ UI ìˆ¨ê¸°ê¸°
                document.getElementById('detail-date').parentElement.style.display = 'flex'; // ë‚ ì§œ/íšŒì‚¬ ì˜ì—­ì€ ë³´ì´ê²Œ
                document.getElementById('detail-title').style.display = 'block'; // ì œëª©ë„ ë³´ì´ê²Œ
                contentHeader.style.display = 'none';
                extraSection.style.display = 'none';
                toolbar.style.display = 'none';

                const skills = [
                    { name: 'PPT', icon: 'fa-file-powerpoint', color: 'text-orange-500' },
                    { name: 'Photoshop', icon: 'fa-palette', color: 'text-blue-500' },
                    { name: 'Premiere Pro', icon: 'fa-film', color: 'text-purple-500' },
                    { name: 'Excel', icon: 'fa-file-excel', color: 'text-green-500' },
                    { name: 'Word', icon: 'fa-file-word', color: 'text-blue-600' }
                ];

                const valuesString = document.querySelector('[data-key="skill-perf-full-desc"]')?.innerHTML || "80,70,60,90,95";
                const values = valuesString.split(',').map(Number);

                let chartHtml = '<div class="space-y-4 mt-8">';
                skills.forEach((skill, index) => {
                    const value = values[index] || 0;
                    chartHtml += `
                        <div class="skill-bar-item">
                            <div class="flex items-center gap-4">
                                <div class="w-24 flex items-center gap-3">
                                    <i class="fas ${skill.icon} ${skill.color} text-2xl w-8 text-center"></i>
                                    <span class="block text-sm font-semibold">${skill.name}</span>
                                </div>
                                <div class="flex-1">
                                    <div class="bg-white/10 rounded-full h-3 overflow-hidden">
                                        <div class="bar bg-primary h-full rounded-full transition-all duration-500" style="width: ${value}%;"></div>
                                    </div>
                                </div>
                                <div class="w-16 text-right font-bold text-base">
                                    <span class="skill-value">${value}%</span>
                                </div>
                            </div>
                    `;
                    if (isEditing) {
                        chartHtml += `
                            <div class="pl-28 mt-2">
                                <input type="range" min="0" max="100" value="${value}" 
                                    class="skill-slider w-full"
                                    oninput="updateSkillBar(this, ${index})">
                            </div>
                        `;
                    }
                    chartHtml += `</div>`;
                });
                chartHtml += '</div>';

                document.getElementById('detail-desc').innerHTML = chartHtml;
                document.getElementById('detail-desc').style.display = 'block';
                overlay.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                return; // ì—¬ê¸°ì„œ í•¨ìˆ˜ ì¢…ë£Œ
            }

            // [ê¸°ëŠ¥ ë³€ê²½] Experience í•­ëª©ì€ ìƒì„¸ ì„¤ëª… ëŒ€ì‹  ì—°ê´€ëœ í”„ë¡œì íŠ¸ ëª©ë¡ í‘œì‹œ
            if (isExp) {
                contentHeader.style.display = 'none'; // ê¸°ë³¸ í—¤ë” ìˆ¨ê¹€
                document.getElementById('detail-desc').style.display = 'none'; // ë³¸ë¬¸ ì˜ì—­ ìˆ¨ê¹€
                document.getElementById('detail-extra').innerHTML = "";

                // [ê¸°ëŠ¥ ìˆ˜ì •] detail-exp-manager ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•˜ì—¬ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ (Recent Workì™€ ë™ì¼ êµ¬ì¡°)
                const expManager = document.getElementById('detail-exp-manager');
                expManager.innerHTML = ""; // ì´ˆê¸°í™”
                
                if (isEditing) {
                    expManager.classList.remove('hidden');
                    expManager.innerHTML += `
                        <h4 class="font-bold text-sm text-gray-400 mb-3 flex items-center gap-2">
                            <span class="material-symbols-outlined text-sm">link</span> í”„ë¡œì íŠ¸ ì—°ê²° (Link Projects)
                        </h4>
                        <div class="flex gap-2 mb-6">
                            <select id="project-selector" class="bg-bgDark border border-white/20 rounded-lg px-3 py-2 flex-1 text-sm text-white focus:border-primary outline-none">
                                <option value="">ì—°ê²°í•  í”„ë¡œì íŠ¸ ì„ íƒ...</option>
                            </select>
                            <button onclick="linkProjectToExperience()" class="bg-primary text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-primary/80 transition-colors">
                                ì¶”ê°€
                            </button>
                        </div>
                        <hr class="border-white/10 my-6">
                    `;
                }
                
                // ì—°ê´€ í”„ë¡œì íŠ¸ ì°¾ê¸° (ë©”ì¸ í™”ë©´ ìˆœì„œëŒ€ë¡œ)
                const projects = document.querySelectorAll('#project-container .editable-trigger-wrapper');
                const projectList = document.createElement('div'); // ì—°ê²°ëœ í”„ë¡œì íŠ¸ ì¹´ë“œ ë‹´ì„ ê³³
                projectList.className = "space-y-4 mt-2 linked-project-container";
                let count = 0;

                projects.forEach(proj => {
                    const projId = proj.id.replace('item-', '');
                    const catEl = proj.querySelector(`[data-key="${projId}-category"]`);
                    const category = catEl ? catEl.innerText.trim() : "General";
                    
                    // ì…€ë ‰í„° ì˜µì…˜ ì¶”ê°€ (ì´ë¯¸ ì—°ê²°ëœê±´ ì œì™¸í•˜ê±°ë‚˜ í‘œì‹œ)
                    if (isEditing) {
                        const option = document.createElement('option');
                        option.value = projId;
                        option.innerText = proj.querySelector(`[data-key="${projId}-title"]`).innerText;
                        if (category === mainTitle.trim()) {
                            option.disabled = true;
                            option.innerText += " (ì´ë¯¸ ì—°ê²°ë¨)";
                        }
                        document.getElementById('project-selector').appendChild(option);
                    }

                    // ì¹´í…Œê³ ë¦¬ê°€ í˜„ì¬ ê²½í—˜ ì œëª©ê³¼ ì¼ì¹˜í•˜ë©´ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
                    if (category === mainTitle.trim()) {
                        count++;
                        const pTitle = proj.querySelector(`[data-key="${projId}-title"]`).innerText;
                        
                        // [ìˆ˜ì •] ì„¤ëª…(desc) ê°€ì ¸ì˜¤ê¸° ì•ˆì „ ì¥ì¹˜ ì¶”ê°€
                        let pDesc = "";
                        const pDescEl = proj.querySelector(`[data-key="${projId}-desc"]`);
                        if (pDescEl) {
                            pDesc = pDescEl.textContent; // innerText ëŒ€ì‹  textContent ì‚¬ìš© (hidden ìš”ì†Œë„ ì½ê¸° ìœ„í•¨)
                        } else {
                            const pFull = proj.querySelector(`[data-key="${projId}-full-desc"]`)?.innerHTML || "";
                            pDesc = pFull.replace(/<[^>]*>?/gm, '').substring(0, 100); // íƒœê·¸ ì œê±° í›„ í…ìŠ¤íŠ¸ë§Œ ì¶”ì¶œ
                        }
                        
                        // [ê¸°ëŠ¥ ì¶”ê°€] ì¸ë„¤ì¼ ì´ë¯¸ì§€ ì¶”ì¶œ
                        const pFullDesc = proj.querySelector(`[data-key="${projId}-full-desc"]`)?.innerHTML || "";
                        const tempDiv = document.createElement('div');
                        tempDiv.innerHTML = pFullDesc;
                        let imgUrl = tempDiv.querySelector('img')?.src;
                        if (!imgUrl) {
                            const bgDiv = tempDiv.querySelector('[style*="background-image"]');
                            if (bgDiv) {
                                const match = bgDiv.style.backgroundImage.match(/url\(['"]?(.*?)['"]?\)/);
                                if (match) imgUrl = match[1];
                            }
                        }
                        
                        const card = document.createElement('div');
                        card.className = "bg-primary/10 p-4 rounded-xl border border-primary/30 cursor-pointer hover:bg-primary/20 transition-colors group relative linked-project-card";
                        card.setAttribute('data-proj-id', projId);
                        card.onclick = function() { openDetail(projId); };
                        
                        if (isEditing) {
                            card.setAttribute('draggable', 'true');
                        }
                        
                        let deleteBtn = '';
                        if (isEditing) {
                            deleteBtn = `
                                <button onclick="unlinkProject(event, '${projId}')" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600 z-10 shadow-md">
                                    <span class="material-symbols-outlined text-[16px]">close</span>
                                </button>
                            `;
                        }

                        let thumbHtml = '';
                        if (imgUrl) {
                            thumbHtml = `<div class="w-16 h-16 rounded-lg bg-cover bg-center flex-shrink-0 border border-white/10 bg-bgDark" style="background-image: url('${imgUrl}')"></div>`;
                        }

                        card.innerHTML = `
                            ${deleteBtn}
                            <div class="flex items-start gap-3">
                                <div class="flex-1 min-w-0">
                                    <div class="text-xs text-primary font-bold mb-1">Linked Project</div>
                                    <h3 class="font-bold text-white text-lg mb-1">${pTitle}</h3>
                                    <p class="text-sm text-textGray line-clamp-1">${pDesc}</p>
                                </div>
                                ${thumbHtml}
                            </div>
                        `;
                        projectList.appendChild(card);
                    }
                });

                if (count > 0) {
                    expManager.classList.remove('hidden');
                    const header = document.createElement('h4');
                    header.className = "font-bold text-sm text-primary mb-3 flex items-center gap-2";
                    header.innerHTML = '<span class="material-symbols-outlined text-sm">link</span> LINKED PROJECTS';
                    
                    expManager.appendChild(header);
                    expManager.appendChild(projectList);
                } else if (!isEditing) {
                    expManager.classList.add('hidden');
                }
            } else {
                document.getElementById('detail-exp-manager').classList.add('hidden'); // ë‹¤ë¥¸ í˜ì´ì§€ì—ì„  ìˆ¨ê¹€
                contentHeader.style.display = 'block'; // ê¸°ë³¸ í—¤ë” ë³´ì„
                // ì¼ë°˜ í•­ëª©(Project, Skill ë“±)ì€ ê¸°ì¡´ ë¡œì§ ìœ ì§€
                const hiddenDesc = document.querySelector(`[data-key="${key}-full-desc"]`);
                const savedFullDesc = hiddenDesc ? hiddenDesc.innerHTML : localStorage.getItem(`${key}-full-desc`);
                document.getElementById('detail-desc').style.display = 'block'; // ë³¸ë¬¸ ì˜ì—­ ë³´ì„
                document.getElementById('detail-desc').innerHTML = savedFullDesc ? savedFullDesc : mainDesc;
                
                const hiddenExtra = document.querySelector(`[data-key="${key}-extra"]`);
                const savedExtra = hiddenExtra ? hiddenExtra.innerHTML : localStorage.getItem(`${key}-extra`);
                document.getElementById('detail-extra').innerHTML = savedExtra ? savedExtra : "-";
            }

            // [ê¸°ëŠ¥ 1] Experience í•­ëª©ì€ ìƒì„¸ ë‚´ìš© ìˆ˜ì • ì œí•œ (íˆ´ë°” ìˆ¨ê¹€ & í¸ì§‘ ë¶ˆê°€)
            const toolbar = document.getElementById('detail-toolbar');
            const descArea = document.getElementById('detail-desc');
            const extraArea = document.getElementById('detail-extra');
            const extraSection = document.getElementById('detail-extra-section');

            if (isExp) {
                toolbar.style.display = 'none';
                extraSection.style.display = 'none';
                // ë‚´ìš©ì€ ë³´ì—¬ì£¼ë˜ í¸ì§‘ì€ ë¶ˆê°€ëŠ¥í•˜ê²Œ
                descArea.contentEditable = "false";
                extraArea.contentEditable = "false";
            } else {
                // ë‹¤ë¥¸ í•­ëª©ë“¤ì€ ì›ë˜ëŒ€ë¡œ
                toolbar.style.display = ''; // CSS í´ë˜ìŠ¤ ë”°ë¦„
                extraSection.style.display = 'block';
            }

            // [ê¸°ëŠ¥ 2] Project ìƒì„¸ í˜ì´ì§€: ì—°ê²°ëœ Experience ì¹´ë“œ í‘œì‹œ
            if (isProj) {
                const catEl = document.querySelector(`[data-key="${key}-category"]`);
                const categoryName = catEl ? catEl.textContent.trim() : "General";

                // í•´ë‹¹ ì¹´í…Œê³ ë¦¬ ì´ë¦„ì„ ê°€ì§„ Experience ì°¾ê¸°
                let linkedExpId = null;
                let linkedExpTitle = "";
                let linkedExpDate = "";
                
                const exps = document.querySelectorAll('#timeline-container .editable-trigger-wrapper');
                exps.forEach(exp => {
                    const eId = exp.id.replace('item-', '');
                    const eTitle = exp.querySelector(`[data-key="${eId}-title"]`).innerText.trim();
                    if (eTitle === categoryName) {
                        linkedExpId = eId;
                        linkedExpTitle = eTitle;
                        linkedExpDate = exp.querySelector(`[data-key="${eId}-date"]`).innerText;
                    }
                });

                if (linkedExpId) {
                    const expManager = document.getElementById('detail-exp-manager');
                    expManager.classList.remove('hidden');
                    expManager.innerHTML = `
                        <h4 class="font-bold text-sm text-primary mb-3">ğŸ”— LINKED EXPERIENCE</h4>
                        <div class="bg-primary/10 p-4 rounded-xl border border-primary/30 cursor-pointer hover:bg-primary/20 transition-colors" onclick="openDetail('${linkedExpId}')">
                            <div class="text-xs text-primary font-bold mb-1">${linkedExpDate}</div>
                            <div class="font-bold text-white text-lg">${linkedExpTitle}</div>
                            <div class="text-xs text-gray-400 mt-1">í´ë¦­í•˜ì—¬ ê²½í—˜ ìƒì„¸ ë³´ê¸° â†’</div>
                        </div>
                    `;
                }
            }

            // í¸ì§‘ ëª¨ë“œ ìƒíƒœë©´ ìƒì„¸ í˜ì´ì§€ ë‚´ë¶€ë„ í¸ì§‘ ê°€ëŠ¥í•˜ê²Œ ì„¤ì •
            if(isEditing) {
                // Experienceê°€ ì•„ë‹ ë•Œë§Œ ìƒì„¸ ë‚´ìš© í¸ì§‘ í—ˆìš©
                document.querySelectorAll('.editable-detail').forEach(el => {
                    if(isExp && (el.id === 'detail-desc' || el.id === 'detail-extra')) return;
                    el.contentEditable = "true";
                });
            } else {
                document.querySelectorAll('.editable-detail').forEach(el => el.contentEditable = "false");
            }

            overlay.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // 4. ìƒì„¸ í˜ì´ì§€ ë‹«ê¸° & ë°ì´í„° ì—­ë°©í–¥ ë™ê¸°í™” (ìƒì„¸ -> ë©”ì¸)
        function closeDetail() {
            if (isEditing && currentActiveKey) {
                // ìˆ˜ì •ëœ ë‚´ìš©ì„ ë©”ì¸ í™”ë©´ìœ¼ë¡œ ì „ì†¡ (Sync)
                syncDetailToMain();
                saveContent(); // ë‹«ì„ ë•Œ ì €ì¥
            }

            document.getElementById('detail-overlay').classList.add('hidden');
            document.body.style.overflow = 'auto';
            currentActiveKey = null;
        }

        // ìƒì„¸ í˜ì´ì§€ ë‚´ìš©ì„ ë©”ì¸ DOMì— ë™ê¸°í™”í•˜ëŠ” í•¨ìˆ˜ (ìë™ ì €ì¥ìš©)
        function syncDetailToMain() {
            if (!currentActiveKey) return;

            const newTitle = document.getElementById('detail-title').innerText;

            const newDate = document.getElementById('detail-date').innerText;
            const newCompany = document.getElementById('detail-company').innerText;
            const newDesc = document.getElementById('detail-desc').innerHTML;

            const titleEl = document.querySelector(`[data-key="${currentActiveKey}-title"]`);
            if(titleEl) titleEl.innerText = newTitle;

            const dateEl = document.querySelector(`[data-key="${currentActiveKey}-date"]`);
            if(dateEl) dateEl.innerText = newDate;

            const compEl = document.querySelector(`[data-key="${currentActiveKey}-company"]`);
            if(compEl) compEl.innerText = newCompany;
            
            // [ìˆ˜ì •] Recent Work í•­ëª© ì„¤ëª…(desc) ì²˜ë¦¬ logic
            let descEl = document.querySelector(`[data-key="${currentActiveKey}-desc"]`);
            
            if (currentActiveKey.startsWith('proj')) {
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = newDesc;
                
                let summaryText = "";
                
                // 1. ë¶ë§ˆí¬ ì„¤ëª… ì°¾ê¸°
                const bookmarkDesc = tempDiv.querySelector('.bookmark-card p');
                if (bookmarkDesc) {
                    summaryText = bookmarkDesc.innerText;
                } else {
                    // 2. ë¶ë§ˆí¬ê°€ ì—†ìœ¼ë©´ ì¼ë°˜ í…ìŠ¤íŠ¸ ì‚¬ìš© (ë¶ë§ˆí¬ ì¹´ë“œ í…ìŠ¤íŠ¸ ì œì™¸)
                    const clones = tempDiv.querySelectorAll('.bookmark-card');
                    clones.forEach(el => el.remove());
                    summaryText = tempDiv.innerText.trim();
                }

                // ì„¤ëª… ìš”ì†Œê°€ ì—†ìœ¼ë©´(ì´ì „ ë²„ì „ ë°ì´í„°) ìƒì„±í•˜ì§€ ì•Šê³  ë„˜ì–´ê°€ê±°ë‚˜, í•„ìš”ì‹œ ìƒì„± ë¡œì§ ì¶”ê°€ ê°€ëŠ¥
                // ì—¬ê¸°ì„œëŠ” ê¸°ì¡´ ìš”ì†Œê°€ ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸í•˜ê³  ìˆ¨ê¹€ í•´ì œ
                if (descEl) {
                    descEl.classList.remove('hidden');
                    descEl.innerText = summaryText ? (summaryText.substring(0, 100) + (summaryText.length > 100 ? "..." : "")) : "ë‚´ìš© ì—†ìŒ";
                }
            } else if(descEl) {
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = newDesc;
                descEl.innerText = tempDiv.innerText.split('\n')[0].substring(0, 50) + "...";
            }

            // Experience í•­ëª©ì€ ìƒì„¸ ë‚´ìš©(ìë™ ìƒì„±ëœ í”„ë¡œì íŠ¸ ëª©ë¡)ì„ ì €ì¥í•˜ì§€ ì•ŠìŒ
            if (!currentActiveKey.startsWith('exp')) {
                const hiddenDesc = document.querySelector(`[data-key="${currentActiveKey}-full-desc"]`);
                if(hiddenDesc) hiddenDesc.innerHTML = newDesc;
                
                const hiddenExtra = document.querySelector(`[data-key="${currentActiveKey}-extra"]`);
                if(hiddenExtra) hiddenExtra.innerHTML = document.getElementById('detail-extra').innerHTML;
            }

            // [ê¸°ëŠ¥ ì¶”ê°€] Recent Work ì¸ë„¤ì¼ ì—…ë°ì´íŠ¸ (ì´ë¯¸ì§€ ë˜ëŠ” ë¶ë§ˆí¬ ì¸ë„¤ì¼ ì¶”ì¶œ)
            if (currentActiveKey.startsWith('proj')) {
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = newDesc;
                
                // 1. ì¼ë°˜ ì´ë¯¸ì§€ ì°¾ê¸°
                let imgUrl = tempDiv.querySelector('img')?.src;
                
                // 2. ë¶ë§ˆí¬ ë°°ê²½ ì´ë¯¸ì§€ ì°¾ê¸° (ì¼ë°˜ ì´ë¯¸ì§€ê°€ ì—†ì„ ê²½ìš°)
                if (!imgUrl) {
                    const bgDiv = tempDiv.querySelector('[style*="background-image"]');
                    if (bgDiv) {
                        const match = bgDiv.style.backgroundImage.match(/url\(['"]?(.*?)['"]?\)/);
                        if (match) imgUrl = match[1];
                    }
                }

                const item = document.getElementById('item-' + currentActiveKey);
                if (item) {
                    let thumbWrapper = item.querySelector('.proj-thumb-wrapper');
                    let thumbImg = thumbWrapper ? thumbWrapper.querySelector('.proj-thumb-img') : null;
                    
                    // [ì²­ì†Œ] ì„¤ëª… ìš”ì†Œê°€ ìˆë‹¤ë©´ ìˆ¨ê¹€ í•´ì œ (ë‹¤ì‹œ ë³´ì—¬ì¤Œ)
                    const strayDesc = item.querySelector(`[data-key="${currentActiveKey}-desc"]`);
                    if (strayDesc) strayDesc.classList.remove('hidden');

                    // [êµ¬ì¡° ë§ˆì´ê·¸ë ˆì´ì…˜] ì¸ë„¤ì¼ ìš”ì†Œê°€ ì—†ìœ¼ë©´(êµ¬ë²„ì „ ë°ì´í„°) êµ¬ì¡°ë¥¼ ê°±ì‹ í•˜ì—¬ ìƒì„±
                    if (!thumbWrapper) {
                        // [ìˆ˜ì •] data-keyë¥¼ ì‚¬ìš©í•˜ì—¬ ìš”ì†Œë¥¼ ë” ì •í™•í•˜ê²Œ ì°¾ìŒ
                        const id = currentActiveKey;
                        const title = item.querySelector(`[data-key="${id}-title"]`);
                        const catEl = item.querySelector(`[data-key="${id}-category"]`);
                        const catRow = catEl ? catEl.closest('.flex') : null; // ì¹´í…Œê³ ë¦¬ë¥¼ ê°ì‹¸ëŠ” ì¤„(row) ì°¾ê¸°

                        if (catRow && title && strayDesc) {
                            // ê¸°ì¡´ ì½˜í…ì¸ ë¥¼ ê°ìŒ€ ì™¼ìª½ ë˜í¼ ìƒì„±
                            const leftCol = document.createElement('div');
                            leftCol.className = 'flex-1 min-w-0';
                            leftCol.appendChild(catRow);
                            leftCol.appendChild(title);
                            leftCol.appendChild(strayDesc); // ì„¤ëª… ì¶”ê°€

                            // ì¸ë„¤ì¼ ìš”ì†Œ ìƒì„±
                            thumbWrapper = document.createElement('div');
                            thumbWrapper.className = 'proj-thumb-wrapper w-20 h-20 rounded-lg overflow-hidden flex-shrink-0 hidden border border-white/10 bg-bgDark';
                            
                            thumbImg = document.createElement('div');
                            thumbImg.className = 'proj-thumb-img w-full h-full bg-cover bg-center transition-transform duration-500 group-hover:scale-110';
                            thumbWrapper.appendChild(thumbImg);

                            // ì „ì²´ ë˜í¼ ìƒì„±
                            const wrapper = document.createElement('div');
                            wrapper.className = 'flex items-start gap-3';
                            wrapper.appendChild(leftCol);
                            wrapper.appendChild(thumbWrapper);

                            // ì•„ì´í…œì— ì¶”ê°€
                            item.appendChild(wrapper);
                        }
                    }

                    if (thumbWrapper && thumbImg) {
                        if (imgUrl) {
                            thumbImg.style.backgroundImage = `url('${imgUrl}')`;
                            thumbWrapper.classList.remove('hidden');
                        } else {
                            thumbWrapper.classList.add('hidden');
                            thumbImg.style.backgroundImage = '';
                        }
                    }
                }
            }
        }

        // [ê¸°ëŠ¥ ì¶”ê°€] ì—°ê²°ëœ í”„ë¡œì íŠ¸ í•´ì œí•˜ê¸°
        function unlinkProject(e, projId) {
            e.stopPropagation(); // ìƒì„¸ í˜ì´ì§€ ì§„ì… ë°©ì§€
            if (!confirm("ì´ í”„ë¡œì íŠ¸ì˜ ì—°ê²°ì„ í•´ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;

            const catEl = document.querySelector(`[data-key="${projId}-category"]`);
            if (catEl) {
                catEl.textContent = "General"; // ì¹´í…Œê³ ë¦¬ ì´ˆê¸°í™”
                saveContent(); // ì €ì¥
                openDetail(currentActiveKey); // í™”ë©´ ê°±ì‹ 
            }
        }

        // [ê¸°ëŠ¥ ì¶”ê°€] Experience ìƒì„¸ í˜ì´ì§€ì—ì„œ í”„ë¡œì íŠ¸ ì—°ê²°í•˜ê¸°
        function linkProjectToExperience() {
            if (!currentActiveKey || !currentActiveKey.startsWith('exp')) return;
            
            // 1. í˜„ì¬ ëª¨ë‹¬ì˜ ë‚´ìš©ì„ ë©”ì¸ ë°ì´í„°ì™€ ë™ê¸°í™” (ì œëª© ë³€ê²½ ì‚¬í•­ ë°˜ì˜)
            syncDetailToMain();

            const select = document.getElementById('project-selector');
            const projId = select.value;
            if (!projId) {
                alert("ì—°ê²°í•  í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
                return;
            }

            // 2. ë™ê¸°í™”ëœ ë©”ì¸ ë°ì´í„°ì—ì„œ ì œëª© ê°€ì ¸ì˜¤ê¸°
            const titleEl = document.querySelector(`[data-key="${currentActiveKey}-title"]`);
            const currentExpTitle = titleEl ? titleEl.innerText.trim() : "";
            
            // 3. ì„ íƒëœ í”„ë¡œì íŠ¸ì˜ ì¹´í…Œê³ ë¦¬ë¥¼ í˜„ì¬ ê²½í—˜ ì œëª©ìœ¼ë¡œ ë³€ê²½
            const catEl = document.querySelector(`[data-key="${projId}-category"]`);
            if (catEl) {
                catEl.textContent = currentExpTitle;
                saveContent(); // ì €ì¥
                // í™”ë©´ ê°±ì‹  (ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€ëœ ëª¨ìŠµ ë³´ì—¬ì£¼ê¸° ìœ„í•´)
                openDetail(currentActiveKey);
            }
        }

        // 5. ì´ë¯¸ì§€ íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
        const imageInput = document.getElementById('imageInput');
        
        // ì´ë¯¸ì§€ í´ë¦­ ì‹œ ì¸í’‹ íŠ¸ë¦¬ê±°
        document.addEventListener('click', function(e) {
            if (isEditing && e.target.tagName === 'IMG' && e.target.classList.contains('editable-img')) {
                currentImgElement = e.target;
                imageInput.click();
            }
        });

        // íŒŒì¼ ì„ íƒ ì‹œ Base64 ë³€í™˜ ë° ì ìš©
        imageInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                if(file.size > 2 * 1024 * 1024) { // 2MB ì œí•œ ì•Œë¦¼
                    alert("ì´ë¯¸ì§€ íŒŒì¼ì´ ë„ˆë¬´ í½ë‹ˆë‹¤! (2MB ì´í•˜ ê¶Œì¥)\në¸Œë¼ìš°ì € ì €ì¥ ìš©ëŸ‰ì„ ì´ˆê³¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
                }
                const reader = new FileReader();
                reader.onload = function(readerEvent) {
                    const base64String = readerEvent.target.result;
                    if(currentImgElement) {
                        currentImgElement.src = base64String;
                        saveContent(); // ì´ë¯¸ì§€ ë³€ê²½ ì¦‰ì‹œ ì €ì¥
                    }
                }
                reader.readAsDataURL(file);
            }
        });

        // ìƒì„¸ í˜ì´ì§€ìš© ì´ë¯¸ì§€ ì‚½ì…
        function triggerDetailImage() {
            document.getElementById('detailImageInput').click();
        }
        
        document.getElementById('detailImageInput').addEventListener('change', async function(e) {
            const files = Array.from(e.target.files);
            if (files.length === 0) return;

            const readFile = (file) => {
                return new Promise(resolve => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve(e.target.result);
                    reader.readAsDataURL(file);
                });
            };

            if (files.length === 1) {
                const src = await readFile(files[0]);
                const imgTag = `
                    <div class="relative group my-4 inline-block max-w-full" contenteditable="false">
                        <img src="${src}" class="max-w-full rounded-lg shadow-md" style="max-height:400px;">
                        <button class="absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600" onclick="this.parentElement.remove(); syncDetailToMain(); saveContent();">
                            <span class="material-symbols-outlined text-[16px]">close</span>
                        </button>
                    </div><br>`;
                document.getElementById('detail-desc').innerHTML += imgTag;
            } else {
                // 2ê°œ ì´ìƒ: íš¡ë‹¨ ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆ
                const srcs = await Promise.all(files.map(f => readFile(f)));
                let imgsHtml = srcs.map(src => 
                    `<div class="horizontal-img-wrapper relative group flex-shrink-0 snap-center cursor-grab" draggable="true" contenteditable="false" tabindex="0">
                        <img src="${src}" class="h-64 w-auto rounded-lg shadow-md bg-black/20 pointer-events-none">
                        <button class="absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600" onclick="this.parentElement.remove(); syncDetailToMain(); saveContent();">
                            <span class="material-symbols-outlined text-[16px]">close</span>
                        </button>
                    </div>`
                ).join('');
                
                const container = `<div class="horizontal-scroll-container flex overflow-x-auto gap-4 my-4 pb-4 snap-x" contenteditable="false" style="scrollbar-width: thin;">${imgsHtml}</div><br>`;
                document.getElementById('detail-desc').innerHTML += container;
            }
            
            syncDetailToMain(); // [ìˆ˜ì •] ì´ë¯¸ì§€ ì¶”ê°€ ì¦‰ì‹œ ë©”ì¸ í™”ë©´ ë™ê¸°í™” (ì¸ë„¤ì¼ ìƒì„±)
            saveContent(); // ì €ì¥
            e.target.value = ''; // ì´ˆê¸°í™”
        });

        function insertDetailLink() {
            const url = prompt("ë§í¬ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš” (https://...):");
            if(url) {
                const text = prompt("ë§í¬ì— í‘œì‹œí•  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:", "ì—¬ê¸° í´ë¦­");
                const linkTag = `<a href="${url}" target="_blank" class="text-primary underline hover:text-white">${text || url}</a>`;
                document.getElementById('detail-desc').innerHTML += " " + linkTag;
                syncDetailToMain(); // [ìˆ˜ì •] ë§í¬ ì¶”ê°€ ì¦‰ì‹œ ë™ê¸°í™”
                saveContent(); // ë§í¬ ì¶”ê°€ ì¦‰ì‹œ ì €ì¥
            }
        }

        // PDF íŒŒì¼ ì²¨ë¶€
        function triggerPdfInput() {
            document.getElementById('pdfInput').click();
        }

        document.getElementById('pdfInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if(!file) return;
            if(file.size > 5 * 1024 * 1024) { // 5MB ì œí•œ
                 alert("íŒŒì¼ì´ ë„ˆë¬´ í½ë‹ˆë‹¤ (5MB ì œí•œ).\në¸Œë¼ìš°ì € ì €ì¥ ìš©ëŸ‰ì„ ì´ˆê³¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
                 return;
            }
            const reader = new FileReader();
            reader.onload = function(evt) {
                const dataUrl = evt.target.result;
                const html = `
                    <a href="${dataUrl}" download="${file.name}" class="flex items-center gap-3 bg-red-500/10 border border-red-500/20 p-2 rounded-lg my-1 hover:bg-red-500/20 transition-colors group no-underline" contenteditable="false">
                        <span class="material-symbols-outlined text-red-500 text-3xl">picture_as_pdf</span>
                        <div class="flex-1 min-w-0">
                            <div class="font-bold text-red-400 group-hover:text-red-300 truncate text-sm">${file.name}</div>
                            <div class="text-xs text-gray-500">PDF Document</div>
                        </div>
                        <span class="material-symbols-outlined text-gray-500">download</span>
                    </a><br>
                `;
                document.getElementById('detail-desc').innerHTML += html;
                syncDetailToMain(); // [ìˆ˜ì •] PDF ì¶”ê°€ ì¦‰ì‹œ ë™ê¸°í™”
                saveContent(); // PDF ì¶”ê°€ ì¦‰ì‹œ ì €ì¥
            };
            reader.readAsDataURL(file);
        });

        async function insertBookmark() {
            let url = prompt("ë¶ë§ˆí¬í•  ë§í¬ ì£¼ì†Œ(URL)ë¥¼ ì…ë ¥í•˜ì„¸ìš”:");
            if (!url) return;
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                url = 'https://' + url;
            }
            
            // ë¡œë”© í‘œì‹œ
            const loadingId = 'loading-' + Date.now();
            document.getElementById('detail-desc').innerHTML += `<div id="${loadingId}" class="text-sm text-gray-500 my-2">ğŸ”„ ë§í¬ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘...</div>`;

            try {
                // Microlink APIë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”íƒ€ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const response = await fetch(`https://api.microlink.io/?url=${encodeURIComponent(url)}`);
                const json = await response.json();
                
                // ë¡œë”© ì œê±°
                const loadingEl = document.getElementById(loadingId);
                if(loadingEl) loadingEl.remove();

                if (json.status === 'success') {
                    const data = json.data;
                    const title = data.title || "ì œëª© ì—†ìŒ";
                    const desc = data.description || "";
                    const image = data.image ? data.image.url : null;
                    
                    let imgHtml = '';
                    let layoutClass = 'block';
                    let heightClass = '';
                    
                    if (image) {
                        // ì´ë¯¸ì§€ê°€ ìˆìœ¼ë©´ ê°€ë¡œ ë°°ì¹˜ (ëª¨ë°”ì¼ì€ ì„¸ë¡œ)
                        imgHtml = `<div class="w-full h-40 md:w-40 md:h-auto bg-cover bg-center flex-shrink-0 border-t md:border-t-0 md:border-l border-white/10" style="background-image: url('${image}');"></div>`;
                        layoutClass = 'flex flex-col-reverse md:flex-row'; 
                        heightClass = 'md:h-32'; // ë°ìŠ¤í¬íƒ‘ ë†’ì´ ê³ ì • (ì•ˆì •ì„± í™•ë³´)
                    }

                    const bookmarkHtml = `
                        <a href="${url}" target="_blank" class="bookmark-card ${layoutClass} bg-white/5 border border-white/10 rounded-xl overflow-hidden my-2 transition-all no-underline ${heightClass}" contenteditable="false">
                            <div class="p-4 flex-1 min-w-0 flex flex-col justify-center">
                                <h4 class="font-bold text-white mb-1 text-lg truncate" contenteditable="true">${title}</h4>
                                <p class="text-sm text-gray-400 mb-2 line-clamp-2" contenteditable="true">${desc}</p>
                                <div class="flex items-center gap-1 text-xs text-primary/80">
                                    <span class="material-symbols-outlined text-[14px]">link</span>
                                    <span class="bookmark-url-text truncate">${url}</span>
                                </div>
                            </div>
                            ${imgHtml}
                        </a><br>
                    `;
                    document.getElementById('detail-desc').innerHTML += bookmarkHtml;
                    syncDetailToMain(); // [ìˆ˜ì •] ë¶ë§ˆí¬ ì¶”ê°€(ì„±ê³µ) ì¦‰ì‹œ ë™ê¸°í™”
                } else {
                    throw new Error("API Fail");
                }
            } catch (e) {
                // ì‹¤íŒ¨ ì‹œ ìˆ˜ë™ ì…ë ¥ìœ¼ë¡œ í´ë°±
                const loadingEl = document.getElementById(loadingId);
                if(loadingEl) loadingEl.remove();

                const title = prompt("ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”:", "ì œëª© ì—†ìŒ");
                const desc = prompt("ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒ):", "");
                
                const bookmarkHtml = `
                    <a href="${url}" target="_blank" class="bookmark-card block bg-white/5 border border-white/10 rounded-xl overflow-hidden my-2 transition-all no-underline" contenteditable="false">
                        <div class="p-3">
                            <h4 class="font-bold text-white mb-1 text-lg" contenteditable="true">${title}</h4>
                            <p class="text-sm text-gray-400 mb-2 line-clamp-2" contenteditable="true">${desc}</p>
                            <div class="flex items-center gap-1 text-xs text-primary/80">
                                <span class="material-symbols-outlined text-[14px]">link</span>
                                <span class="bookmark-url-text truncate">${url}</span>
                            </div>
                        </div>
                    </a><br>
                `;
                document.getElementById('detail-desc').innerHTML += bookmarkHtml;
                syncDetailToMain(); // [ìˆ˜ì •] ë¶ë§ˆí¬ ì¶”ê°€(ìˆ˜ë™) ì¦‰ì‹œ ë™ê¸°í™”
                saveContent(); // ë¶ë§ˆí¬ ìˆ˜ë™ ì…ë ¥ ì‹œ ì €ì¥
            }
        }

        // 6. ë§í¬ ë° ì§€ë„ í¸ì§‘
        document.addEventListener('click', function(e) {
            if (!isEditing) return;
            
            // ë§í¬ ìˆ˜ì •
            const link = e.target.closest('a');
            if (link && (link.classList.contains('editable-link') || link.classList.contains('bookmark-card'))) {
                // í…ìŠ¤íŠ¸ í¸ì§‘ ì¤‘ì´ë©´ ë§í¬ ìˆ˜ì • íŒì—… ë¬´ì‹œ
                if (e.target.isContentEditable) return;

                e.preventDefault();
                const newUrl = prompt("ì´ë™í•  ë§í¬ ì£¼ì†Œ(URL)ë¥¼ ì…ë ¥í•˜ì„¸ìš”:", link.href);
                if (newUrl) {
                    link.href = newUrl;
                    const urlText = link.querySelector('.bookmark-url-text');
                    if(urlText) urlText.innerText = newUrl;
                    syncDetailToMain(); // [ìˆ˜ì •] ë§í¬ ìˆ˜ì • ì¦‰ì‹œ ë™ê¸°í™”
                    saveContent(); // ë§í¬ ìˆ˜ì • ì¦‰ì‹œ ì €ì¥
                }
                return;
            }
        });

        function editMap() {
            if (isEditing) {
                const frame = document.getElementById('map-frame');
                const instruction = "ì§€ë„ì— í‘œì‹œí•  'ì£¼ì†Œ' (ì˜ˆ: ì„œìš¸ ê°•ë‚¨êµ¬) ë˜ëŠ”\nêµ¬ê¸€ ì§€ë„ ê³µìœ  ë§í¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”.";
                const input = prompt(instruction, "ìˆ­ì‹¤ëŒ€í•™êµ");
                
                if (input) {
                    // iframe íƒœê·¸ë‚˜ URLì¸ ê²½ìš° ê¸°ì¡´ ë¡œì§ ìœ ì§€
                    if(input.includes('<iframe') || input.includes('http')) {
                        if(input.includes('<iframe')) {
                            const srcMatch = input.match(/src="([^"]+)"/);
                            if(srcMatch) frame.src = srcMatch[1];
                        } else {
                            frame.src = input;
                        }
                    } else {
                        // ì£¼ì†Œ ì…ë ¥ ì‹œ êµ¬ê¸€ ì§€ë„ ì„ë² ë“œ URL ìƒì„±
                        frame.src = `https://maps.google.com/maps?q=${encodeURIComponent(input)}&t=&z=13&ie=UTF8&iwloc=&output=embed`;
                    }
                    saveContent(); // ì§€ë„ ë³€ê²½ ì¦‰ì‹œ ì €ì¥
                }
            }
        }

        // ë§ˆí¬ë‹¤ìš´ ìë™ ì ìš© (í¬ì»¤ìŠ¤ í•´ì œ ì‹œ)
        document.getElementById('detail-desc').addEventListener('blur', applyMarkdown);

        // ë§ˆí¬ë‹¤ìš´ ì ìš© í•¨ìˆ˜
        function applyMarkdown() {
            const desc = document.getElementById('detail-desc');
            const walker = document.createTreeWalker(desc, NodeFilter.SHOW_TEXT, null, false);
            const nodes = [];
            while(walker.nextNode()) nodes.push(walker.currentNode);
            
            nodes.forEach(node => {
                const text = node.nodeValue;
                const parent = node.parentNode;
                
                // ì´ë¯¸ ë³€í™˜ëœ ìš”ì†Œë‚˜ ë¶ë§ˆí¬ ë“±ì€ ê±´ë„ˆëœ€
                if (parent.closest('.bookmark-card') || parent.closest('a')) return;
                if (!text.trim()) return;

                let newEl = null;

                // # ì œëª© (H3)
                if (text.match(/^#\s+(.+)/)) {
                    newEl = document.createElement('h3');
                    newEl.className = "text-2xl font-bold text-white mt-6 mb-3 border-b border-white/10 pb-2";
                    newEl.textContent = text.replace(/^#\s+/, '');
                }
                // ## ì†Œì œëª© (H4)
                else if (text.match(/^##\s+(.+)/)) {
                    newEl = document.createElement('h4');
                    newEl.className = "text-xl font-bold text-gray-200 mt-4 mb-2";
                    newEl.textContent = text.replace(/^##\s+/, '');
                }
                // - ë¦¬ìŠ¤íŠ¸
                else if (text.match(/^-\s+(.+)/)) {
                    newEl = document.createElement('div');
                    newEl.className = "flex items-baseline gap-2 text-gray-300 ml-2 mb-1";
                    newEl.innerHTML = `<span class="text-primary text-[8px]">â—</span><span>${text.replace(/^-\s+/, '')}</span>`;
                }

                if (newEl) {
                    // í…ìŠ¤íŠ¸ ë…¸ë“œê°€ div ë“±ìœ¼ë¡œ ê°ì‹¸ì ¸ ìˆìœ¼ë©´ ë¶€ëª¨ë¥¼ êµì²´, ì•„ë‹ˆë©´ ë…¸ë“œ ìì²´ êµì²´
                    if (parent.tagName === 'DIV' && parent.childNodes.length === 1 && parent !== desc) {
                        parent.replaceWith(newEl);
                    } else {
                        node.replaceWith(newEl);
                    }
                }
            });
        }

        // ìƒˆ ì•„ì´í…œ ì¶”ê°€
        function addNewItem(type) {
            const id = type + Date.now(); // ìœ ë‹ˆí¬ ID ìƒì„±
            let html = '';
            let container = null;

            if(type === 'exp') {
                container = document.getElementById('timeline-container');
                html = `
                <div id="item-${id}" class="editable-trigger-wrapper editable-trigger relative pl-6 border-l-2 border-primary/30 hover:border-primary transition-colors cursor-pointer group" onclick="openDetail('${id}')">
                    <div data-key="${id}-full-desc" style="display:none;"></div><div data-key="${id}-extra" style="display:none;"></div>
                    <button class="delete-btn material-symbols-outlined text-[16px]" onclick="deleteItem(event, 'item-${id}')">close</button>
                    <span class="absolute -left-[9px] top-0 w-4 h-4 rounded-full bg-bgDark border-2 border-primary group-hover:scale-110 transition-transform"></span>
                    <span class="text-xs text-primary font-bold mb-1 block" data-key="${id}-date">DATE</span>
                    <h3 class="text-lg font-bold mb-1" data-key="${id}-title">New Experience</h3>
                    <p class="text-sm text-textGray" data-key="${id}-company">Company Name</p>
                </div>`;
            } else if(type === 'proj') {
                container = document.getElementById('project-container');
                html = `
                <div id="item-${id}" class="editable-trigger-wrapper editable-trigger bg-bgDark/50 p-4 rounded-xl border border-white/5 hover:border-primary/50 transition-all cursor-pointer group" onclick="openDetail('${id}')">
                    <div data-key="${id}-full-desc" style="display:none;"></div><div data-key="${id}-extra" style="display:none;"></div>
                    <button class="delete-btn material-symbols-outlined text-[16px]" onclick="deleteItem(event, 'item-${id}')">close</button>
                    <div class="flex items-start gap-3">
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-start mb-1">
                                <span class="bg-primary/20 text-primary text-xs px-2 py-0.5 rounded font-bold truncate max-w-[120px]" data-key="${id}-category">General</span>
                                <span class="material-symbols-outlined text-gray-500 group-hover:text-white text-sm">arrow_outward</span>
                            </div>
                            <h3 class="text-lg font-bold text-white mb-1" data-key="${id}-title">New Project</h3>
                            <p class="text-sm text-textGray line-clamp-2" data-key="${id}-desc">Description</p>
                        </div>
                        <div class="proj-thumb-wrapper w-20 h-20 rounded-lg overflow-hidden flex-shrink-0 hidden border border-white/10 bg-bgDark">
                            <div class="proj-thumb-img w-full h-full bg-cover bg-center transition-transform duration-500 group-hover:scale-110"></div>
                        </div>
                    </div>
                </div>`;
            }

            if(container) {
                container.insertAdjacentHTML('afterbegin', html);
                
                // í¸ì§‘ ëª¨ë“œë¼ë©´ ìƒˆë¡œ ì¶”ê°€ëœ í•­ëª©ë„ ë“œë˜ê·¸ ê°€ëŠ¥í•˜ê²Œ ì„¤ì •
                if(isEditing) {
                    const newItem = document.getElementById('item-' + id);
                    if(newItem) {
                        newItem.classList.add('editable-trigger');
                        newItem.setAttribute('draggable', 'true');
                    }
                    saveContent(); // í•­ëª© ì¶”ê°€ ì¦‰ì‹œ ì €ì¥
                }
            }
        }

        function deleteItem(e, itemId) {
            e.stopPropagation(); // ë¶€ëª¨ í´ë¦­ ë°©ì§€
            if(confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                document.getElementById(itemId).remove();
                saveContent(); // í•­ëª© ì‚­ì œ ì¦‰ì‹œ ì €ì¥
            }
        }

        // 7. ë°ì´í„° ì €ì¥ (LocalStorage)
        function saveContent() {
            const data = {};
            // IDê°€ ìˆëŠ” ìš”ì†Œ ì €ì¥
            document.querySelectorAll('[id]').forEach(el => {
                if (el.classList.contains('editable-text-direct')) data[el.id] = el.innerHTML;
                if (el.tagName === 'IMG' && el.classList.contains('editable-img')) data[el.id + '_src'] = el.src;
                if (el.tagName === 'A' && el.classList.contains('editable-link')) data[el.id + '_href'] = el.href;
                if (el.tagName === 'IFRAME') data[el.id + '_src'] = el.src;
            });
            // data-key ìš”ì†Œ ì €ì¥ (ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ)
            document.querySelectorAll('[data-key]').forEach(el => {
                data[el.getAttribute('data-key')] = el.innerHTML;
            });
            
            // ì»¨í…Œì´ë„ˆ êµ¬ì¡° ì €ì¥ (ì¶”ê°€/ì‚­ì œ ë°˜ì˜)
            data['container_timeline'] = document.getElementById('timeline-container').innerHTML;
            data['container_project'] = document.getElementById('project-container').innerHTML;
            data['container_awards'] = document.getElementById('awards-container').innerHTML;

            // í…Œë§ˆ ìƒ‰ìƒ ì €ì¥
            data['theme_color'] = document.documentElement.style.getPropertyValue('--primary-color');

            localStorage.setItem('portfolioData_v2', JSON.stringify(data));
        }

        // 9. ì‚¬ì´íŠ¸ ë‚´ë³´ë‚´ê¸° (ê³µìœ ìš© HTML ìƒì„±)
        function exportHTML() {
            if(isEditing) toggleEditMode(); // í¸ì§‘ ëª¨ë“œ ì¢…ë£Œ í›„ ì €ì¥

            const clone = document.documentElement.cloneNode(true);
            
            // í¸ì§‘ ê´€ë ¨ UI ì œê±°
            clone.querySelectorAll('#editToggleBtn, #exportBtn, #imageInput, #detailImageInput, #pdfInput, #themeColorPicker, #resetThemeBtn, .add-btn, .delete-btn, .editor-toolbar').forEach(el => el.remove());
            
            // ìŠ¤í¬ë¦½íŠ¸ êµì²´ (ë·°ì–´ ì „ìš©ìœ¼ë¡œ ë‹¨ìˆœí™”)
            const oldScript = clone.querySelector('body > script');
            oldScript.innerHTML = `
                function openDetail(key) {
                    const item = document.getElementById('item-' + key);
                    if(!item) return;
                    
                    const title = item.querySelector('[data-key$="-title"]')?.innerText || "";
                    const date = item.querySelector('[data-key$="-date"]')?.innerText || "";
                    const company = item.querySelector('[data-key$="-company"]')?.innerText || "";
                    
                    const fullDesc = item.querySelector('[data-key$="-full-desc"]')?.innerHTML;
                    const extra = item.querySelector('[data-key$="-extra"]')?.innerHTML;
                    const mainDesc = item.querySelector('[data-key$="-desc"]')?.innerText;

                    document.getElementById('detail-title').innerText = title;
                    document.getElementById('detail-date').innerText = date;
                    document.getElementById('detail-company').innerText = company;
                    document.getElementById('detail-desc').innerHTML = fullDesc || mainDesc || "";
                    document.getElementById('detail-extra').innerHTML = extra || "";
                    
                    document.getElementById('detail-overlay').classList.remove('hidden');
                    document.body.style.overflow = 'hidden';
                }

                function closeDetail() {
                    document.getElementById('detail-overlay').classList.add('hidden');
                    document.body.style.overflow = 'auto';
                }
            `;

            const htmlContent = "<!DOCTYPE html>\\n" + clone.outerHTML;
            const blob = new Blob([htmlContent], {type: 'text/html'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'index.html';
            a.click();
        }

        // 8. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        function loadContent() {
            const savedData = localStorage.getItem('portfolioData_v2');
            if (savedData) {
                const data = JSON.parse(savedData);
                
                // êµ¬ì¡° ë¨¼ì € ë³µì›
                if(data['container_timeline']) document.getElementById('timeline-container').innerHTML = data['container_timeline'];
                if(data['container_project']) document.getElementById('project-container').innerHTML = data['container_project'];
                if(data['container_awards']) document.getElementById('awards-container').innerHTML = data['container_awards'];

                // ë°ì´í„° ì±„ìš°ê¸°
                for (const key in data) {
                    if (key.endsWith('_src')) {
                        const id = key.slice(0, -4); // '_src' ì œê±°í•˜ì—¬ ì‹¤ì œ ID ì¶”ì¶œ
                        const el = document.getElementById(id);
                        if (el) el.src = data[key];
                    } else if (key.endsWith('_href')) {
                        const id = key.slice(0, -5); // '_href' ì œê±°í•˜ì—¬ ì‹¤ì œ ID ì¶”ì¶œ
                        const el = document.getElementById(id);
                        if (el) el.href = data[key];
                    } else {
                        const el = document.getElementById(key);
                        if (el) el.innerHTML = data[key];
                    }
                }
                document.querySelectorAll('[data-key]').forEach(el => {
                    const key = el.getAttribute('data-key');
                    if (data[key]) el.innerHTML = data[key];
                });

                // í…Œë§ˆ ìƒ‰ìƒ ë³µì›
                if(data['theme_color']) {
                    changeThemeColor(data['theme_color']);
                    document.getElementById('themeColorPicker').value = data['theme_color'];
                }
                
                // [ì¶”ê°€] Recent Work ì¹´ë“œ êµ¬ì¡° ì¼ê´„ ì •ë¦¬ (ì„¤ëª… ì œê±° ë° ì¸ë„¤ì¼ êµ¬ì¡° í™•ì¸)
                fixProjectLayouts();
            }
        }

        function fixProjectLayouts() {
            document.querySelectorAll('#project-container .editable-trigger-wrapper').forEach(item => {
                const id = item.id.replace('item-', '');
                
                // ì„¤ëª… ìš”ì†Œ ë³µêµ¬ (ìˆ¨ê¹€ í•´ì œ)
                const descEl = item.querySelector(`[data-key="${id}-desc"]`);
                if (descEl) descEl.classList.remove('hidden');
                
                // ì¸ë„¤ì¼ êµ¬ì¡°ê°€ ì•„ë‹ˆë©´ ë³€í™˜
                if (!item.querySelector('.proj-thumb-wrapper')) {
                    const title = item.querySelector(`[data-key="${id}-title"]`);
                    const catEl = item.querySelector(`[data-key="${id}-category"]`);
                    const catRow = catEl ? catEl.closest('.flex') : null;
                    
                    if (catRow && title && descEl) {
                        const leftCol = document.createElement('div');
                        leftCol.className = 'flex-1 min-w-0';
                        leftCol.appendChild(catRow);
                        leftCol.appendChild(title);
                        leftCol.appendChild(descEl);
                        
                        const thumbWrapper = document.createElement('div');
                        thumbWrapper.className = 'proj-thumb-wrapper w-20 h-20 rounded-lg overflow-hidden flex-shrink-0 hidden border border-white/10 bg-bgDark';
                        
                        const thumbImg = document.createElement('div');
                        thumbImg.className = 'proj-thumb-img w-full h-full bg-cover bg-center transition-transform duration-500 group-hover:scale-110';
                        thumbWrapper.appendChild(thumbImg);
                        
                        const wrapper = document.createElement('div');
                        wrapper.className = 'flex items-start gap-3';
                        wrapper.appendChild(leftCol);
                        wrapper.appendChild(thumbWrapper);
                        
                        item.appendChild(wrapper);
                    }
                }
            });
        }

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ (Experience & Recent Work)
        const dragContainers = [document.getElementById('timeline-container'), document.getElementById('project-container')];
        
        dragContainers.forEach(container => {
            container.addEventListener('dragstart', e => {
                if (!isEditing) {
                    e.preventDefault();
                    return;
                }
                const draggable = e.target.closest('.editable-trigger-wrapper');
                if (draggable) {
                    draggable.classList.add('dragging');
                }
            });

            container.addEventListener('dragend', e => {
                const draggable = e.target.closest('.editable-trigger-wrapper');
                if (draggable) {
                    draggable.classList.remove('dragging');
                    if(isEditing) saveContent(); // ë“œë˜ê·¸ ì¢…ë£Œ(ìˆœì„œ ë³€ê²½) ì‹œ ì €ì¥
                }
            });

            container.addEventListener('dragover', e => {
                if (!isEditing) return;
                e.preventDefault(); // ë“œë¡­ í—ˆìš©
                const afterElement = getDragAfterElement(container, e.clientY);
                const draggable = container.querySelector('.dragging');
                if (draggable) {
                    if (afterElement == null) {
                        container.appendChild(draggable);
                    } else {
                        container.insertBefore(draggable, afterElement);
                    }
                }
            });
        });

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.editable-trigger-wrapper:not(.dragging)')];

            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        // ìë™ ì €ì¥ (Debounce: ì…ë ¥ì´ ë©ˆì¶”ë©´ 0.5ì´ˆ ë’¤ ì €ì¥)
        const debouncedSave = debounce(() => saveContent(), 500);
        function debounce(func, timeout = 300){
            let timer;
            return (...args) => {
                clearTimeout(timer);
                timer = setTimeout(() => { func.apply(this, args); }, timeout);
            };
        }

        document.addEventListener('input', function(e) {
            if(isEditing) {
                if(currentActiveKey) syncDetailToMain(); // ìƒì„¸ í˜ì´ì§€ í¸ì§‘ ì¤‘ì´ë©´ ë©”ì¸ DOMê³¼ ë™ê¸°í™”
                debouncedSave(); // ìë™ ì €ì¥
            }
        });

        // ìƒì„¸ í˜ì´ì§€ ê°€ë¡œ ìŠ¤í¬ë¡¤ ì´ë¯¸ì§€ ë“œë˜ê·¸ ì•¤ ë“œë¡­ & ì‚­ì œ í‚¤
        const detailDesc = document.getElementById('detail-desc');
        
        detailDesc.addEventListener('dragstart', e => {
            if (!isEditing) { e.preventDefault(); return; }
            const wrapper = e.target.closest('.horizontal-img-wrapper');
            const projCard = e.target.closest('.linked-project-card');
            
            if (wrapper) {
                wrapper.classList.add('dragging');
                e.dataTransfer.effectAllowed = 'move';
                return;
            }
            
            if (projCard) {
                projCard.classList.add('dragging');
                e.dataTransfer.effectAllowed = 'move';
            }
        });

        detailDesc.addEventListener('dragend', e => {
            const wrapper = e.target.closest('.horizontal-img-wrapper');
            const projCard = e.target.closest('.linked-project-card');
            
            if (wrapper) {
                wrapper.classList.remove('dragging');
                syncDetailToMain(); // [ìˆ˜ì •] ìˆœì„œ ë³€ê²½ ì‹œ ë™ê¸°í™”
                saveContent();
                return;
            }
            
            if (projCard) {
                projCard.classList.remove('dragging');
                
                // ë©”ì¸ ì»¨í…Œì´ë„ˆ ìˆœì„œ ë™ê¸°í™”
                const container = projCard.closest('.linked-project-container');
                if (container) {
                    const newOrderIds = Array.from(container.querySelectorAll('.linked-project-card'))
                                             .map(el => el.getAttribute('data-proj-id'));
                    
                    const mainContainer = document.getElementById('project-container');
                    
                    // ë³€ê²½ëœ ìˆœì„œëŒ€ë¡œ ë©”ì¸ ì»¨í…Œì´ë„ˆì˜ ë§¨ ë’¤ë¡œ ì´ë™ (ê·¸ë£¹í™” ë° ì •ë ¬ íš¨ê³¼)
                    newOrderIds.forEach(id => {
                        const el = document.getElementById('item-' + id);
                        if (el) mainContainer.appendChild(el);
                    });
                }
                
                saveContent();
            }
        });

        detailDesc.addEventListener('dragover', e => {
            if (!isEditing) return;
            const container = e.target.closest('.horizontal-scroll-container');
            const linkedContainer = e.target.closest('.linked-project-container');
            
            if (container) {
                e.preventDefault();
                const afterElement = getHorizontalDragAfterElement(container, e.clientX);
                const draggable = container.querySelector('.dragging');
                if (draggable) {
                    if (afterElement == null) {
                        container.appendChild(draggable);
                    } else {
                        container.insertBefore(draggable, afterElement);
                    }
                }
                return;
            }
            
            if (linkedContainer) {
                e.preventDefault();
                const afterElement = getVerticalDragAfterElement(linkedContainer, e.clientY);
                const draggable = linkedContainer.querySelector('.dragging');
                if (draggable) {
                    if (afterElement == null) {
                        linkedContainer.appendChild(draggable);
                    } else {
                        linkedContainer.insertBefore(draggable, afterElement);
                    }
                }
            }
        });

        function getHorizontalDragAfterElement(container, x) {
            const draggableElements = [...container.querySelectorAll('.horizontal-img-wrapper:not(.dragging)')];
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = x - box.left - box.width / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }
        
        function getVerticalDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.linked-project-card:not(.dragging)')];
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        // ì´ë¯¸ì§€ ë˜í¼ ì„ íƒ í›„ Delete í‚¤ë¡œ ì‚­ì œ
        detailDesc.addEventListener('keydown', e => {
            if (!isEditing) return;
            if (e.key === 'Delete' || e.key === 'Backspace') {
                const focused = document.activeElement;
                if (focused && focused.classList.contains('horizontal-img-wrapper') && detailDesc.contains(focused)) {
                    e.preventDefault();
                    focused.remove();
                    syncDetailToMain(); // [ìˆ˜ì •] ì‚­ì œ ì‹œ ë™ê¸°í™”
                    saveContent();
                }
            }
        });

        // ìŠ¤í‚¬ ë Œë”ë§ ë° ì—…ë°ì´íŠ¸
        function renderSkills() {
            const container = document.getElementById('skill-container');
            const dataEl = document.getElementById('skill-data');
            if(!container || !dataEl) return;

            const valuesString = dataEl.innerText.trim();
            const values = valuesString ? valuesString.split(',').map(Number) : [80,70,60,90,95];
            let html = '';

            skillConfig.forEach((skill, i) => {
                const val = values[i] || 0;
                const bgColorClass = skill.color.replace('text-', 'bg-');
                html += `
                    <div class="skill-row group">
                        <div class="skill-icon"><i class="fas ${skill.icon} ${skill.color}"></i></div>
                        <div class="skill-name text-gray-300">${skill.name}</div>
                        <div class="flex-1 relative">
                            <div class="skill-bar-bg">
                                <div class="skill-bar-fill ${bgColorClass}" style="width: ${val}%"></div>
                            </div>
                            ${isEditing ? `<input type="range" min="0" max="100" value="${val}" class="skill-slider absolute top-[-5px] left-0 w-full group-hover:opacity-100 transition-opacity" oninput="updateSkillValue(${i}, this.value)">` : ''}
                        </div>
                        <div class="text-xs font-bold w-8 text-right text-primary">${val}%</div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        function updateSkillValue(index, val) {
            const dataEl = document.getElementById('skill-data');
            const values = dataEl.innerText.split(',');
            values[index] = val;
            dataEl.innerText = values.join(',');
            
            const container = document.getElementById('skill-container');
            const row = container.children[index];
            if (row) {
                row.querySelector('.skill-bar-fill').style.width = val + '%';
                row.querySelector('.text-right').innerText = val + '%';
            }
            
            saveContent();
        }

        // ìˆ˜ìƒ ë‚´ì—­ ì¶”ê°€
        function addAward() {
            const html = `
                <div class="award-card bg-white/5 p-3 rounded-xl border border-white/5 flex items-center gap-3 group relative">
                    <div class="w-10 h-10 rounded-full bg-yellow-500/20 flex items-center justify-center flex-shrink-0 text-yellow-400">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="text-xs text-gray-400 editable-text-direct" contenteditable="true">DATE</div>
                        <div class="font-bold text-sm text-white truncate editable-text-direct" contenteditable="true">New Award Title</div>
                    </div>
                    <button class="delete-btn material-symbols-outlined text-[14px]" onclick="this.closest('.award-card').remove(); saveContent();">close</button>
                </div>`;
            document.getElementById('awards-container').insertAdjacentHTML('afterbegin', html);
            saveContent();
        }
    </script>
</body>
</html>
